{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<nav class="navbar navbar-expand-lg navbar-light bg-light mb-4">
  
  <div class="collapse navbar-collapse">
    <ul class="navbar-nav ml-auto">
      {% if current_user.is_authenticated %}
      <li class="nav-item">
        <a class="nav-link" href="{{ url_for('logout') }}">Se déconnecter</a>
      </li>
      {% else %}
      <li class="nav-item">
        <a class="nav-link" href="{{ url_for('login') }}">Se connecter</a>
      </li>
      {% endif %}
    </ul>
  </div>
</nav>

<div class="container mt-4">
  <h2 class="mb-4">Vos Compétences</h2>

  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div class="alert alert-info">
        {% for message in messages %}
          <div>{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <form method="post" action="{{ url_for('ajouter_competence') }}" class="mb-4">
    <div class="form-group">
      <input type="text" name="nom" placeholder="Nom de la compétence" class="form-control mb-2" required>
      <input type="text" name="niveau" placeholder="Niveau" class="form-control mb-2" required>
      <select name="semestre" class="form-control mb-2" required>
        <option value="">-- Choisir un semestre --</option>
        <option value="S1">S1</option>
        <option value="S2">S2</option>
        <option value="S3">S3</option>
        <option value="S4">S4</option>
      </select>
    </div>
    <button type="submit" class="btn btn-primary">Ajouter compétence</button>
  </form>

  {% if competences %}
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Semestre</th>
          <th>Nom</th>
          <th>Niveau</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for comp in competences %}
          <tr>
            <td>{{ comp.semestre }}</td>
            <td>{{ comp.nom }}</td>
            <td>{{ comp.niveau }}</td>
            <td>
              <a href="{{ url_for('supprimer_competence', id=comp.id) }}"
                 class="btn btn-sm btn-danger"
                 onclick="return confirm('Supprimer cette compétence ?')">
                 Supprimer
              </a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p class="text-muted">Aucune compétence encore ajoutée.</p>
  {% endif %}
</div>
{% endblock %}

